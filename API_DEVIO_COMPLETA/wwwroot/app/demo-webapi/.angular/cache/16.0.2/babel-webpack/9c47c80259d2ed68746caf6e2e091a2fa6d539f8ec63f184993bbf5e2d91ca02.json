{"ast":null,"code":"import { FormBuilder, FormControl } from '@angular/forms';\nimport { Router } from '@angular/router';\nimport { ProdutoService } from '../services/produtoService';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../services/produtoService\";\nimport * as i4 from \"@angular/common\";\nfunction CadastroComponent_div_6_li_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    var error_r5 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(error_r5);\n  }\n}\nfunction CadastroComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 31)(1, \"h3\", 32);\n    i0.ɵɵtext(2, \"Opa! Alguma coisa n\\u00E3o deu certo:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ul\");\n    i0.ɵɵtemplate(4, CadastroComponent_div_6_li_4_Template, 2, 1, \"li\", 33);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    var ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.errors);\n  }\n}\nfunction CadastroComponent_option_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 34);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    var fornecedor_r6 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"value\", fornecedor_r6.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(fornecedor_r6.nome);\n  }\n}\nfunction CadastroComponent_label_31_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"label\", 35);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    var ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r3.imagemNome);\n  }\n}\nvar _c0 = function () {\n  return [\"/lista-produtos\"];\n};\nexport var CadastroComponent = /** @class */function () {\n  function CadastroComponent(fb, router, produtoService) {\n    var _this = this;\n    this.fb = fb;\n    this.router = router;\n    this.produtoService = produtoService;\n    this.errors = [];\n    this.produtoService.obterFornecedores().subscribe(function (fornecedores) {\n      return _this.fornecedores = fornecedores;\n    }, function (fail) {\n      return _this.errors = fail.error.errors;\n    });\n    this.imagemForm = new FormData();\n  }\n  CadastroComponent.prototype.ngOnInit = function () {\n    this.produtoForm = this.fb.group({\n      fornecedorId: '',\n      nome: '',\n      descricao: '',\n      imagemUpload: '',\n      imagem: '',\n      valor: '0',\n      ativo: new FormControl(false),\n      nomeFornecedor: ''\n    });\n  };\n  CadastroComponent.prototype.cadastrarProduto = function () {\n    var _this = this;\n    if (this.produtoForm.valid && this.produtoForm.dirty) {\n      var produtoForm = Object.assign({}, this.produto, this.produtoForm.value);\n      produtoForm.ativo = this.produtoForm.get('ativo').value;\n      this.produtoHandle(produtoForm).subscribe(function (result) {\n        _this.onSaveComplete(result);\n      }, function (fail) {\n        _this.onError(fail);\n      });\n    }\n  };\n  CadastroComponent.prototype.onSaveComplete = function (response) {\n    this.router.navigate(['/lista-produtos']);\n  };\n  CadastroComponent.prototype.onError = function (fail) {\n    this.errors = fail.error.errors;\n  };\n  CadastroComponent.prototype.produtoHandleAlternativo = function (produto) {\n    var formdata = new FormData();\n    produto.imagem = this.imagemNome;\n    produto.imagemUpload = null;\n    formdata.append('produto', JSON.stringify(produto));\n    formdata.append('ImagemUpload', this.imagemForm, this.imagemNome);\n    return this.produtoService.registrarProdutoAlternativo(formdata);\n  };\n  CadastroComponent.prototype.produtoHandle = function (produto) {\n    produto.imagemUpload = this.imageBase64;\n    produto.imagem = this.imagemNome;\n    return this.produtoService.registrarProduto(produto);\n  };\n  CadastroComponent.prototype.upload = function (file) {\n    // necessario para upload via IformFile\n    this.imagemForm = file[0];\n    this.imagemNome = file[0].name;\n    // necessario para upload via base64\n    var reader = new FileReader();\n    reader.onload = this.manipularReader.bind(this);\n    reader.readAsBinaryString(file[0]);\n  };\n  CadastroComponent.prototype.manipularReader = function (readerEvt) {\n    var binaryString = readerEvt.target.result;\n    this.imageBase64 = btoa(binaryString);\n  };\n  CadastroComponent.ɵfac = function CadastroComponent_Factory(t) {\n    return new (t || CadastroComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.ProdutoService));\n  };\n  CadastroComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CadastroComponent,\n    selectors: [[\"app-cadastro\"]],\n    decls: 46,\n    vars: 6,\n    consts: [[2, \"padding-top\", \"50px\"], [1, \"row\"], [1, \"col-md-10\"], [\"enctype\", \"multipart/form-data\", 3, \"formGroup\", \"ngSubmit\"], [\"class\", \"alert alert-danger\", 4, \"ngIf\"], [1, \"form-group\"], [\"for\", \"FornecedorId\", 1, \"control-label\"], [\"data-val\", \"true\", \"formControlName\", \"fornecedorId\", \"data-val-required\", \"O campo Fornecedor \\u00E9 obrigat\\u00F3rio\", \"id\", \"FornecedorId\", \"name\", \"FornecedorId\", 1, \"form-control\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"data-valmsg-for\", \"FornecedorId\", \"data-valmsg-replace\", \"true\", 1, \"text-danger\", \"field-validation-valid\"], [\"for\", \"Nome\", 1, \"control-label\"], [\"formControlName\", \"nome\", \"type\", \"text\", \"data-val\", \"true\", \"data-val-length\", \"O campo Nome precisa ter entre 2 e 200 caracteres\", \"data-val-length-max\", \"200\", \"data-val-length-min\", \"2\", \"data-val-required\", \"O campo Nome \\u00E9 obrigat\\u00F3rio\", \"id\", \"Nome\", \"maxlength\", \"200\", \"name\", \"Nome\", \"value\", \"\", 1, \"form-control\"], [\"data-valmsg-for\", \"Nome\", \"data-valmsg-replace\", \"true\", 1, \"text-danger\", \"field-validation-valid\"], [\"for\", \"Descricao\", 1, \"control-label\"], [\"formControlName\", \"descricao\", \"cols\", \"40\", \"rows\", \"5\", \"data-val\", \"true\", \"data-val-length\", \"O campo Descri\\u00E7\\u00E3o precisa ter entre 2 e 1000 caracteres\", \"data-val-length-max\", \"1000\", \"data-val-length-min\", \"2\", \"data-val-required\", \"O campo Descri\\u00E7\\u00E3o \\u00E9 obrigat\\u00F3rio\", \"id\", \"Descricao\", \"maxlength\", \"1000\", \"name\", \"Descricao\", 1, \"form-control\"], [\"data-valmsg-for\", \"Descricao\", \"data-valmsg-replace\", \"true\", 1, \"text-danger\", \"field-validation-valid\"], [\"for\", \"ImagemUpload\", 1, \"control-label\"], [1, \"custom-file\"], [\"accept\", \"image/jpeg\", \"formControlName\", \"imagemUpload\", \"type\", \"file\", \"id\", \"ImagemUpload\", \"name\", \"ImagemUpload\", \"data-val\", \"true\", \"data-val-required\", \"Preencha o campo Imagem\", 1, \"custom-file-input\", 3, \"change\"], [\"fileInput\", \"\"], [\"data-browse\", \"Procurar\", \"for\", \"ImagemUpload\", 1, \"custom-file-label\", 2, \"width\", \"400px\"], [\"id\", \"img_nome\", 4, \"ngIf\"], [\"data-valmsg-for\", \"ImagemUpload\", \"data-valmsg-replace\", \"true\", 1, \"text-danger\", \"field-validation-valid\"], [\"for\", \"Valor\", 1, \"control-label\"], [\"formControlName\", \"valor\", \"type\", \"text\", \"data-val\", \"true\", \"data-val-moeda\", \"Moeda em formato inv\\u00E1lido\", \"data-val-number\", \"Moeda em formato inv\\u00E1lido\", \"data-val-required\", \"O campo Valor \\u00E9 obrigat\\u00F3rio\", \"id\", \"Valor\", \"name\", \"Valor\", \"value\", \"0,00\", 1, \"form-control\"], [\"data-valmsg-for\", \"Valor\", \"data-valmsg-replace\", \"true\", 1, \"text-danger\", \"field-validation-valid\"], [1, \"form-group\", \"form-check\"], [1, \"form-check-label\"], [\"formControlName\", \"ativo\", \"type\", \"checkbox\", \"data-val\", \"true\", \"data-val-required\", \"The Ativo? field is required.\", \"id\", \"Ativo\", \"name\", \"Ativo\", \"value\", \"true\", 1, \"form-check-input\"], [\"type\", \"submit\", \"value\", \"Cadastrar\", 1, \"btn\", \"btn-primary\"], [1, \"btn\", \"btn-info\", 3, \"routerLink\"], [1, \"alert\", \"alert-danger\"], [\"id\", \"msgRetorno\"], [4, \"ngFor\", \"ngForOf\"], [3, \"value\"], [\"id\", \"img_nome\"]],\n    template: function CadastroComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        var _r7 = i0.ɵɵgetCurrentView();\n        i0.ɵɵelementStart(0, \"h3\", 0);\n        i0.ɵɵtext(1, \"Novo Produto \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(2, \"hr\");\n        i0.ɵɵelementStart(3, \"div\", 1)(4, \"div\", 2)(5, \"form\", 3);\n        i0.ɵɵlistener(\"ngSubmit\", function CadastroComponent_Template_form_ngSubmit_5_listener() {\n          return ctx.cadastrarProduto();\n        });\n        i0.ɵɵtemplate(6, CadastroComponent_div_6_Template, 5, 1, \"div\", 4);\n        i0.ɵɵelementStart(7, \"div\", 5)(8, \"label\", 6);\n        i0.ɵɵtext(9, \"Fornecedor\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"select\", 7);\n        i0.ɵɵelement(11, \"option\");\n        i0.ɵɵtemplate(12, CadastroComponent_option_12_Template, 2, 2, \"option\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(13, \"span\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"div\", 5)(15, \"label\", 10);\n        i0.ɵɵtext(16, \"Nome\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(17, \"input\", 11)(18, \"span\", 12);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"div\", 5)(20, \"label\", 13);\n        i0.ɵɵtext(21, \"Descri\\u00E7\\u00E3o\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(22, \"textarea\", 14)(23, \"span\", 15);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"div\", 5)(25, \"label\", 16);\n        i0.ɵɵtext(26, \"Imagem do Produto\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(27, \"div\", 17)(28, \"input\", 18, 19);\n        i0.ɵɵlistener(\"change\", function CadastroComponent_Template_input_change_28_listener() {\n          i0.ɵɵrestoreView(_r7);\n          var _r2 = i0.ɵɵreference(29);\n          return i0.ɵɵresetView(ctx.upload(_r2.files));\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(30, \"label\", 20);\n        i0.ɵɵtemplate(31, CadastroComponent_label_31_Template, 2, 1, \"label\", 21);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(32, \"span\", 22);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(33, \"div\", 5)(34, \"label\", 23);\n        i0.ɵɵtext(35, \"Valor\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(36, \"input\", 24)(37, \"span\", 25);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(38, \"div\", 26)(39, \"label\", 27);\n        i0.ɵɵelement(40, \"input\", 28);\n        i0.ɵɵtext(41, \" Ativo? \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(42, \"div\", 5);\n        i0.ɵɵelement(43, \"input\", 29);\n        i0.ɵɵelementStart(44, \"a\", 30);\n        i0.ɵɵtext(45, \"Voltar\");\n        i0.ɵɵelementEnd()()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"formGroup\", ctx.produtoForm);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.errors.length > 0);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngForOf\", ctx.fornecedores);\n        i0.ɵɵadvance(19);\n        i0.ɵɵproperty(\"ngIf\", ctx.imagemNome);\n        i0.ɵɵadvance(13);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(5, _c0));\n      }\n    },\n    dependencies: [i4.NgForOf, i4.NgIf, i2.RouterLink, i1.ɵNgNoValidate, i1.NgSelectOption, i1.ɵNgSelectMultipleOption, i1.DefaultValueAccessor, i1.CheckboxControlValueAccessor, i1.SelectControlValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.MaxLengthValidator, i1.FormGroupDirective, i1.FormControlName],\n    encapsulation: 2\n  });\n  return CadastroComponent;\n}();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}